# Project Title

Linear scaling reveals low-dimensional structure in observable microbial dynamics

## Authors

Zhengqing Zhou, Xiaoli Chen, Emrah Şimşek, Grayson S. Hamrick, Yasa Baig, Zachary A. Holmes, Zhenjiao Du, David K. Karig, Lingchong You

Irida Shyti helped setting up the GitHub repository.

## Contents

This repository/archive contains the following components:

- `gLV_simulation_VAE/`: numerical simulation of different gLV models, neural network analyses on the generated data (VAE and MLP)
- `Keio_comm_assembly/`: data and neural network analyses on the fluorescence dynamics in synthetic Keio communities
- `lab_microbiome/`: neural network analyses on the longitudinal composition data of environment-derived microbial communities (Fujita et al. 2023 Microbiome)
- `vaginal_microbiome/`: neural network analyses on the longitudinal composition data of human vaginal microbiomes (Ravel et al. 2013 Microbiome)
- `requirements.txt`: virtual environment for running the neural network analyses
- `README.md`: Project description and usage instructions

## Usage

### Requirements

See the `requirements.txt` file for virtual environment requirement.

For the full dataset and trained models, please refer to Zenodo: 10.5281/zenodo.15659948

### Running the Code

1. Open the jupyter notebooks under each directory
2. Jupyter notebooks give example training instances. 
2. Run cells sequentially to reproduce results in the paper

### File Descriptions

| File/Folder                                              | Description                                                                                    |
|----------------------------------------------------------|------------------------------------------------------------------------------------------------|
| `gLV_simulation_VAE/`                          	   | Scripts used to run model simulations and neural network analyses                              |
| `gLV_simulation_VAE/Summary_VAE_expfit.ipynb`  	   | Jupyter notebook to analyze the VAE training results                                           |
| `gLV_simulation_VAE/MLP_random.ipynb`          	   | Jupyter notebook to analyze the MLP training results                                           |
| `gLV_simulation_VAE/simulation code/`          	   | Scripts to run different gLV model simulations                                                 |
| `gLV_simulation_VAE/saved_sims/`               	   | Generated simulation data for VAE and MLP training                                             |
| `gLV_simulation_VAE/vae_models/`               	   | Trained VAE models to compress the target dynamics                                             |
| `gLV_simulation_VAE/mlp_models/`               	   | Trained MLP models to map the initial abundance to the embeddings                              |
| `gLV_simulation_VAE/saved_data/`               	   | Summary data of VAE models, generated by the Jupyter notebook                                  |

| `Keio_comm_assembly/`                                    | Scripts used to perform neural network analyses on the synthetic Keio community dynamics       |
| `Keio_comm_assembly/Nano_target_dynamics_train/test.npy` | Train and test datasets for VAE training                                     	            |
| `Keio_comm_assembly/sequenced_data/`           	   | NGS results and corresponding target dynamics, used for MLP training                           |
| `Keio_comm_assembly/VAE_on_FP_populations.ipynb` 	   | Jupyter notebook to analyze the VAE training results                                           |
| `Keio_comm_assembly/VAE_on_single_target.ipynb` 	   | Jupyter notebook to analyze the MLP training results                                           |
| `Keio_comm_assembly/vae_models/`               	   | Trained VAE models to compress the target dynamics                                             |
| `Keio_comm_assembly/mlp_models/`               	   | Trained MLP models to map the endpoint abundance of the plasmid carriers to the embeddings     |
| `Keio_comm_assembly/saved_data/`               	   | Summary data of VAE models, generated by the Jupyter notebook                                  |

| `lab_microbiome/`                               	   | Scripts used to perform neural network analyses on the environment-derived microbiome dynamics |
| `lab_microbiome/lab_microbiome_datasets_CV/`    	   | Datasets for environment-derived microbiome dynamics for VAE training                          |
| `lab_microbiome/LabMicrobiome_Ec_CV.ipynb`      	   | Jupyter notebook to analyze the VAE training results                                           |
| `lab_microbiome/LabMicrobiome_MLP_target_forecast.ipynb` | Jupyter notebook to analyze the MLP models to forecast target ASV dynamics      		    |
| `lab_microbiome/LabMicrobiome_MLP_commshift.ipynb` 	   | Jupyter notebook to analyze the MLP models for community shift                     	    |
| `lab_microbiome/vae_models/`                   	   | Trained VAE models to compress the target dynamics                                             |
| `lab_microbiome/mlp_models/`                   	   | Trained MLP models to map the embedding to target dynamics or community shift for forecasting  |
| `lab_microbiome/lab_microbiome_embedding_FUV_CV/` 	   | Summary data of VAE models, generated by the Jupyter notebook                                  |
| `lab_microbiome/target_forecast/`              	   | Results from MLP models to forecast target ASV dynamics                                        |
| `lab_microbiome/community_shift/`              	   | Results from MLP models to forecast community shifts                                           |

| `vaginal_microbiome/`                          	   | Scripts used to perform neural network analyses on the human vaginal microbiome dynamics       |
| `vaginal_microbiome/vaginal_datasets_CV/`      	   | Datasets for vaginal microbiome dynamics for VAE training                                      |
| `vaginal_microbiome/Vaginal_Microbiome_Ec_CV.ipynb` 	   | Jupyter notebook to analyze the VAE training results                                           |
| `vaginal_microbiome/vae_models_CV/`            	   | Trained VAE models to compress the target dynamics                                             |
| `vaginal_microbiome/vaginal_embedding_FUV_CV/` 	   | Summary data of VAE models, generated by the Jupyter notebook                                  |

| `requirements.txt`                             	   | Virtual environment requirements to run the Jupyter notebook analyses                          |
| `README.md`                                     	   | This file                                                                                      |


## Citation

If you use this archive, please cite:

```
Zhengqing Zhou, Xiaoli Chen, Emrah Şimşek, Grayson S. Hamrick, Yasa Baig, Zachary A. Holmes, Zhenjiao Du, David K. Karig, Lingchong You. Low dimensional observable dynamics. Zenodo. https://doi.org/10.5281/zenodo.15659948
```

## License

This project is licensed under the MIT License.

## Contact

For questions, please contact:

- Lingchong You (lingchong.you@duke.edu)
- Department of Biomedical Engineering, Duke University
